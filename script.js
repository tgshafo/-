// –î–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫)
const members = [
    {
        role: "creator",
        nick: "—à–∞—Ñ–æ",
        user: "@nothevo",
        project: "https://t.me/+xm9o_NoMxjVjNjgy",
        description: "–° 2022 –≥–æ–¥–∞ –≤ –∫–º. –ù–∞—á–∏–Ω–∞–ª —Å –ª–∏–∫–∏ —à–∞—Ñ—Ä–æ, –ø–æ–¥ –Ω–µ–π –±—ã–ª–∏ –≤—ã–ª–∏–¥–Ω—É—Ç—ã –∞–º–µ—Ä–∏–∫–∞–Ω–æ, –æ–≤–Ω–µ—Ä –∫–ª–∞–Ω–∞ –º–æ–Ω—Ö–∞–π–∑ –∏ –∞–ø–æ—Å—Ç–∞–ª. –õ–∏–∫–∞ —à–∞—Ñ—Ä–æ –±—ã–ª–∞ –≤—Ç–æ—Ä–æ–π, –∞ –ª–∏–∫–∞ —à–∞—Ñ–æ - —Ç—Ä–µ—Ç—å–µ–π –ª–∏–∫–∏. –í—Å–µ –µ—â–µ –ø—Ä–∏ –º–Ω–µ.",
        details: "–í–ª–∞–¥–µ–ª–µ—Ü –§–µ–π–º –õ–∏—Å—Ç–∞. –ü—Ä–æ–µ–∫—Ç—ã: https://t.me/+xm9o_NoMxjVjNjgy"
    },
    {
        role: "high",
        nick: "—Å–≤–µ—Ä–∫",
        user: "@vsrns",
        project: "https://t.me/+UO-WJgp_j65iYjA6",
        description: "–ê–¥–∞–ø—Ç–µ—Ä - https://t.me/adaptervsnrs | —Ñ–æ—Ä—É–º - https://t.me/+PlU4yvMwrH1jOTJi | –æ–≤–Ω–µ—Ä –∫–ª–∞–Ω–∞ #watch –∏ –ø—Ä–∏–ø–∏—Å–∫–∏ @esrrty | –≤ –∫–º —Å 2022 | –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.",
        details: "–ò–º–µ—é —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –≤–º–µ—Å—Ç–µ —Å —à–∞—Ñ–æ. –ï—Å—Ç—å –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–ª–∞–Ω–∞—Ö, —á–∞—Ç–∞—Ö –∏ —Å–∏–ª—å–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–∞—Ö."
    },
    {
        role: "high",
        nick: "—Ç–∏—Ö–∏–π —à–µ–ø–æ—Ç",
        user: "@vrnqs_official",
        project: "https://t.me/blogshepot",
        description: "–¢–∏—Ö–∏–π —à–µ–ø–æ—Ç - –º–µ–¥–∏–π–Ω–∞—è –ª–∏—á–Ω–æ—Å—Ç—å –≤ –ö–ú.",
        details: "–í–ª–∞–¥–µ–ª–µ—Ü –ø—Ä–æ–µ–∫—Ç–∞ blogshepot"
    },
    {
        role: "high",
        nick: "zup",
        user: "@zupnetov",
        project: "https://t.me/+5QB0M2tY3XxjMGM6",
        description: "–ù–∏–∫ - zup. –†–∞–Ω–µ–µ –±—ã–ª –±–æ–¥ –ª–∏–∫–æ–π –ï–≤–≥–µ–Ω–∏–π –ö–∞–ª–∞—à–Ω–∏–∫–æ–≤, –±—ã–ª–∏ –≤—ã–¥–∞–Ω—ã –ø—Ä–∞–≤–∞ –Ω–∞ –≤—Ä–µ–º—è –æ–≤–Ω–µ—Ä–∞ (–∞–∫–∫–∞—É–Ω—Ç –ê–ª–µ–∫—Å–µ—è –ö–∞–ª–∞—à–Ω–∏–∫–æ–≤–∞). –ë—ã–ª–∞ –µ—â–µ –ª–∏–∫–∞ huxgu —É–±–∏–π—Ü–µ–≤.",
        details: "–í –ö–ú —Å –∫–æ–Ω—Ü–∞ 2019 –≥–æ–¥–∞. –ê–∫—Ç—É–∞–ª–µ–Ω –∫–∞–∫ –õ–∏—Å—Ç–æ–ø–∞–¥–æ–≤."
    },
    {
        role: "low",
        nick: "–∞–ø–∞—Ç–∏",
        user: "@apathydll",
        project: "–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞",
        description: "–° 2025 –≥–æ–¥–∞ –≤ –ö–ú.",
        details: "–ù–æ–≤–∏—á–æ–∫ –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏."
    },
    {
        role: "medium",
        nick: "Zwezdochetow",
        user: "@Zwezdochetow",
        project: "https://t.me/+hvM0Ph9KsyVmZmQy",
        description: "–° 2022 –≥–æ–¥–∞ –≤ –ö–ú.",
        details: "–£—á–∞—Å—Ç–Ω–∏–∫ –§–µ–π–º –õ–∏—Å—Ç–∞ —Å 2022 –≥–æ–¥–∞."
    },
    {
        role: "medium",
        nick: "–≤–µ—Ä—Ö–æ–≤–Ω—ã–π –º–ª–∞–¥—à–∏–π",
        user: "@r1bog",
        project: "https://t.me/+2eQ3tkjjC_M3ZTJi",
        description: "–° 2022 –≥–æ–¥–∞ –≤ –ö–ú.",
        details: "–£—á–∞—Å—Ç–Ω–∏–∫ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è."
    },
    {
        role: "high",
        nick: "akronimow",
        user: "@ipfisher",
        project: "https://t.me/+2eQ3tkjjC_M3ZTJi",
        description: "–° 2020 –≥–æ–¥–∞ –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏. –Ø–≤–ª—è—é—Å—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –ø—Ä–æ–µ–∫—Ç–∞ SwagaBitches. –î–∞–Ω–Ω—ã–π –Ω–µ–π–º —Å 25 –≥–æ–¥–∞. –°–∏–¥–µ–ª –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏ —Å 20 –≥–æ–¥–∞, –Ω–∞ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç —è–≤–ª—è–ª—Å—è spartancevv –∏ —Å–∏–¥–µ–ª –≤ –¥–∏—Å–∫–æ—Ä–¥ –∫–æ–º—å—é–Ω–∏—Ç–∏.",
        details: "–í–ª–∞–¥–µ–ª–µ—Ü SwagaBitches."
    },
    {
        role: "high",
        nick: "–•–∏–º–∏–∫",
        user: "@ximiath",
        project: "https://t.me/+VFlTx32RHEBmZDVk",
        description: "–° 2022 –≥–æ–¥–∞ –≤ –ö–ú.",
        details: "–í—ã—Å–æ–∫–∏–π —Ñ–µ–π–º –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏."
    },
    {
        role: "medium",
        nick: "ksitamin maniac",
        user: "@attackksitami",
        project: "https://t.me/domksitami",
        description: "–£—á–∞—Å—Ç–Ω–∏–∫ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è.",
        details: "–í–ª–∞–¥–µ–ª–µ—Ü domksitami."
    },
    {
        role: "low",
        nick: "–®–∞—Ñ–æ –º–ª–∞–¥—à–∏–π",
        user: "@attakshafo",
        project: "https://t.me/+xm9o_NoMxjVjNjgy",
        description: "–° 2024 –≥–æ–¥–∞ –≤ –ö–ú.",
        details: "–ú–ª–∞–¥—à–∏–π —É—á–∞—Å—Ç–Ω–∏–∫."
    },
    {
        role: "low",
        nick: "–ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—Ü",
        user: "@freakrip",
        project: "–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞",
        description: "–° 2022 –≥–æ–¥–∞ –≤ –ö–ú.",
        details: "–ù–∏–∑–∫–∏–π —Ñ–µ–π–º."
    },
    {
        role: "medium",
        nick: "–º–∞–¥–æ–≤",
        user: "@obpeza",
        project: "–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞",
        description: "–í –ö–ú —Å –∫–æ–Ω—Ü–∞ 2024 –≥–æ–¥–∞. –ü—Ä–æ–µ–∫—Ç—ã: —Ä—É–≤–¥ (–≤ –∫–æ—Ç–æ—Ä–æ–º —â–∞—Å –æ–≤–Ω–µ—Ä –∞–º—Ñ–∏, —Å—Ç–æ—è–ª –Ω–∞ –æ–≤–Ω–µ—Ä–µ), –ú—Ä–∞—á–Ω—ã–µ –¢—É—á–∏ - 450 —Å–∞–±–æ–≤ (—Å–Ω–æ—Å–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –Ω–∞ –∞–¥–º –±—ã–ª hardcrime, –∞–∫—Ç–æ–≥–µ–Ω–æ–≤).",
        details: "–£—á–∞—Å—Ç–Ω–∏–∫ —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è."
    },
    {
        role: "medium",
        nick: "haetripov | Patrick",
        user: "@haetripov",
        project: "https://t.me/+e6YzF5gT7gRkNmVi",
        description: "–ö—Ä—É—Ç–æ –¥–µ–∞–Ω–æ–Ω–µ—Ä üíÄ –∏ —Å–æ–∑–¥–∞—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ –∫—Ä–æ–≤–∞–≤—ã–π –≤–æ—Ä–æ–Ω.",
        details: "–°–æ–∑–¥–∞—Ç–µ–ª—å –∫—Ä–æ–≤–∞–≤—ã–π –≤–æ—Ä–æ–Ω."
    },
    {
        role: "medium",
        nick: "–ø–∏—Ä–∞—Ç—Å–∫–∏–π —Å–µ–Ω—è",
        user: "@swatoan",
        project: "https://t.me/+WKBMyH1IIfxjMTNi",
        description: "–ó–∞—à–µ–ª –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –≤ –∫–º 2022 –≥–æ–¥—É –∏ –∏–º–µ—é —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è –∫–∞–Ω–∞–ª—ã ¬´–ø–∏—Ä–∞—Ç—Å–∫–∏–π —Å–µ–Ω—è¬ª ¬´–∫–∏–±–µ—Ä–ø—Ä–∏—Å–º–∞¬ª. –°–∏–¥–µ–ª –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏ –≤–∫, –¥—Å, —Ç–≥.",
        details: "–í–ª–∞–¥–µ–ª–µ—Ü –ø–∏—Ä–∞—Ç—Å–∫–∏–π —Å–µ–Ω—è –∏ –∫–∏–±–µ—Ä–ø—Ä–∏—Å–º–∞."
    },
    {
        role: "medium",
        nick: "–ø–∞—Ä—Ç–∏–∑–∞–Ω",
        user: "@ocyrn",
        project: "https://t.me/+jg_465t9-yJlODE0",
        description: "–° 2024 –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏. –Ø–≤–ª—è—é—Å—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –ø—Ä–æ–µ–∫—Ç–∞ –°–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –ß–µ—Ä–Ω—ã–π —Å–ª–µ–¥. –î–∞–Ω–Ω—ã–π –Ω–µ–π–º —Å 2025, —Å–∏–∂—É –≤ –∫–æ–º—å—é–Ω–∏—Ç–∏ —Å 23 –≥–æ–¥–∞, –Ω–∞ —Ç–æ—Ç –º–æ–º–µ–Ω—Ç —è–≤–ª—è–ª—Å—è merry –∏ —Å–∏–¥–µ–ª –≤ —Ç–≥ –∫–æ–º—å—é–Ω–∏—Ç–∏.",
        details: "–í–ª–∞–¥–µ–ª–µ—Ü –°–æ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –ß–µ—Ä–Ω—ã–π —Å–ª–µ–¥."
    }
];

// –¶–≤–µ—Ç–∞ –Ω–µ–æ–Ω–∞
const neonColors = {
    red: '#ff0000',
    green: '#00ff00',
    blue: '#0000ff',
    yellow: '#ffff00',
    orange: '#ff8800',
    cyan: '#00ffff',
    pink: '#ff00ff',
    purple: '#aa00ff'
};

// –¢–µ–∫—É—â–∏–π —Ü–≤–µ—Ç –Ω–µ–æ–Ω–∞
let currentColor = '#ff0000';

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', function() {
    initNavigation();
    initMembers();
    initSnow();
    initModals();
    initSettings();
    initRealTime();
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
function initNavigation() {
    const navButtons = document.querySelectorAll('.nav-btn');
    const sections = document.querySelectorAll('section');
    
    navButtons.forEach(button => {
        button.addEventListener('click', function() {
            const target = this.dataset.target;
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            navButtons.forEach(btn => btn.classList.remove('active'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Ç–µ–∫—É—â–µ–π –∫–Ω–æ–ø–∫–µ
            this.classList.add('active');
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫
            if (this.classList.contains('login-btn')) {
                openModal('login-modal');
                return;
            }
            
            if (this.classList.contains('settings-btn')) {
                openModal('settings-modal');
                return;
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
            if (target) {
                sections.forEach(section => {
                    section.classList.remove('active-section');
                    if (section.id === target) {
                        section.classList.add('active-section');
                        
                        // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Å–µ–∫—Ü–∏–∏
                        setTimeout(() => {
                            section.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'start' 
                            });
                        }, 100);
                    }
                });
            }
        });
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function initMembers() {
    loadMembers('all');
    
    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
    document.querySelectorAll('.neon-cat-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.neon-cat-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            loadMembers(this.dataset.category);
        });
    });
    
    // –ü–æ–∏—Å–∫
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            filterMembers(searchTerm);
        });
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function loadMembers(category = 'all') {
    const container = document.getElementById('members-container');
    if (!container) return;
    
    container.innerHTML = '';
    
    const filtered = category === 'all' 
        ? members 
        : members.filter(m => m.role === category);
    
    filtered.forEach(member => {
        const card = createMemberCard(member);
        container.appendChild(card);
    });
}

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
function filterMembers(searchTerm) {
    const cards = document.querySelectorAll('.member-card');
    const activeCategory = document.querySelector('.neon-cat-btn.active').dataset.category;
    
    cards.forEach(card => {
        const nick = card.querySelector('.member-nick').textContent.toLowerCase();
        const user = card.querySelector('.member-user').textContent.toLowerCase();
        const desc = card.querySelector('.member-desc').textContent.toLowerCase();
        
        const matchesSearch = nick.includes(searchTerm) || 
                            user.includes(searchTerm) || 
                            desc.includes(searchTerm);
        
        const matchesCategory = activeCategory === 'all' || 
                              card.dataset.role === activeCategory;
        
        if (matchesSearch && matchesCategory) {
            card.style.display = 'block';
            setTimeout(() => {
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, 10);
        } else {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            setTimeout(() => {
                card.style.display = 'none';
            }, 300);
        }
    });
}

// –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞
function createMemberCard(member) {
    const card = document.createElement('div');
    card.className = 'member-card';
    card.dataset.role = member.role;
    
    const roleName = getRoleName(member.role);
    const projectLink = member.project !== '–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞' 
        ? `<a href="${member.project}" target="_blank"><i class="fas fa-link"></i> –ü—Ä–æ–µ–∫—Ç</a>`
        : '<span class="no-project">–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞</span>';
    
    card.innerHTML = `
        <div class="member-role">${roleName}</div>
        <h3 class="member-nick">${member.nick}</h3>
        <div class="member-user">${member.user}</div>
        <div class="member-project">${projectLink}</div>
        <p class="member-desc">${member.description}</p>
        <button class="details-btn" onclick="showDetails('${member.nick}')">
            <i class="fas fa-info-circle"></i> –ü–æ–¥—Ä–æ–±–Ω–µ–µ
        </button>
    `;
    
    card.style.opacity = '0';
    card.style.transform = 'translateY(20px)';
    card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
    
    setTimeout(() => {
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
    }, 100);
    
    return card;
}

// –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞
function showDetails(nick) {
    const member = members.find(m => m.nick === nick);
    if (!member) return;
    
    const detailsContent = document.getElementById('details-content');
    const roleName = getRoleName(member.role);
    
    detailsContent.innerHTML = `
        <h3>${member.nick}</h3>
        <div class="detail-item">
            <strong>–†–æ–ª—å:</strong> ${roleName}
        </div>
        <div class="detail-item">
            <strong>–Æ–∑–µ—Ä–Ω–µ–π–º:</strong> ${member.user}
        </div>
        <div class="detail-item">
            <strong>–ü—Ä–æ–µ–∫—Ç:</strong> 
            ${member.project !== '–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞' 
                ? `<a href="${member.project}" target="_blank">${member.project}</a>` 
                : '–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞'}
        </div>
        <div class="detail-item">
            <strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong>
            <p>${member.details}</p>
        </div>
        <div class="detail-item">
            <strong>–í –ö–ú —Å:</strong> ${getYearsInKM(member.description)}
        </div>
    `;
    
    openModal('details-modal');
}

// –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ —Ä–æ–ª–∏
function getRoleName(role) {
    const roles = {
        creator: '–°–æ–∑–¥–∞—Ç–µ–ª—å',
        high: '–í—ã—Å–æ–∫–∏–π —Ñ–µ–π–º',
        medium: '–°—Ä–µ–¥–Ω–∏–π —Ñ–µ–π–º',
        low: '–ú–∞–ª—ã–π —Ñ–µ–π–º'
    };
    return roles[role] || role;
}

// –ü–æ–ª—É—á–∏—Ç—å –≥–æ–¥—ã –≤ –ö–ú –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è
function getYearsInKM(desc) {
    const yearMatch = desc.match(/(20\d{2})/);
    return yearMatch ? yearMatch[1] : '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–Ω–µ–≥–∞
function initSnow() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    createSnowflakes();
    
    // –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–Ω–µ–≥–∞
    const snowToggle = document.getElementById('snow-toggle');
    if (snowToggle) {
        snowToggle.addEventListener('change', function() {
            if (this.checked) {
                snowContainer.style.display = 'block';
                createSnowflakes();
            } else {
                snowContainer.style.display = 'none';
                snowContainer.innerHTML = '';
            }
        });
    }
}

// –°–æ–∑–¥–∞–Ω–∏–µ —Å–Ω–µ–∂–∏–Ω–æ–∫
function createSnowflakes() {
    const snowContainer = document.querySelector('.snow-container');
    if (!snowContainer) return;
    
    snowContainer.innerHTML = '';
    
    // –°–æ–∑–¥–∞–µ–º 50 —Å–Ω–µ–∂–∏–Ω–æ–∫
    for (let i = 0; i < 50; i++) {
        const snowflake = document.createElement('div');
        snowflake.className = 'snowflake';
        
        // –°–ª—É—á–∞–π–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        const size = Math.random() * 5 + 3;
        const startX = Math.random() * 100;
        const duration = Math.random() * 10 + 10;
        const delay = Math.random() * 5;
        const opacity = Math.random() * 0.7 + 0.3;
        
        snowflake.style.width = `${size}px`;
        snowflake.style.height = `${size}px`;
        snowflake.style.left = `${startX}vw`;
        snowflake.style.animationDuration = `${duration}s`;
        snowflake.style.animationDelay = `${delay}s`;
        snowflake.style.opacity = opacity;
        snowflake.style.backgroundColor = `rgba(255, 255, 255, ${opacity})`;
        
        snowContainer.appendChild(snowflake);
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
function initModals() {
    // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    document.querySelectorAll('[data-modal]').forEach(btn => {
        btn.addEventListener('click', function() {
            const modalId = this.dataset.modal;
            openModal(modalId);
        });
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
    document.querySelectorAll('.close-modal').forEach(btn => {
        btn.addEventListener('click', function() {
            closeModal(this.closest('.modal'));
        });
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
    window.addEventListener('click', function(event) {
        if (event.target.classList.contains('modal')) {
            closeModal(event.target);
        }
    });
    
    // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
    const loginForm = document.getElementById('login-form');
    if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username && password) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage (–¥–µ–º–æ)
                localStorage.setItem('fame_username', username);
                localStorage.setItem('fame_logged_in', 'true');
                
                alert(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${username}! –ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω.`);
                closeModal(document.getElementById('login-modal'));
                loginForm.reset();
            }
        });
    }
}

// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

// –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function closeModal(modal) {
    if (modal) {
        modal.classList.remove('active');
        document.body.style.overflow = 'auto';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
function initSettings() {
    // –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞
    document.querySelectorAll('.color-option').forEach(option => {
        option.addEventListener('click', function() {
            document.querySelectorAll('.color-option').forEach(opt => {
                opt.classList.remove('active');
            });
            
            this.classList.add('active');
            const color = this.dataset.color;
            const colorName = this.dataset.name;
            
            setNeonColor(color, colorName);
        });
    });
    
    // –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –Ω–µ–æ–Ω–∞
    const intensitySlider = document.getElementById('neon-intensity');
    const intensityValue = document.getElementById('intensity-value');
    
    if (intensitySlider && intensityValue) {
        intensitySlider.addEventListener('input', function() {
            const value = this.value;
            intensityValue.textContent = value;
            updateNeonIntensity(value);
        });
    }
    
    // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ localStorage
    loadSettings();
}

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ü–≤–µ—Ç–∞ –Ω–µ–æ–Ω–∞
function setNeonColor(color, colorName) {
    currentColor = color;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    document.documentElement.style.setProperty('--neon-color', color);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –Ω–µ–æ–Ω–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
    updateAllNeonElements(color);
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
    saveSettings();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –Ω–µ–æ–Ω–∞
function updateNeonIntensity(intensity) {
    const elements = document.querySelectorAll('.neon-nav, .neon-btn, .member-card, .neon-input, .modal-content');
    
    elements.forEach(el => {
        el.style.boxShadow = `0 0 ${intensity * 3}px var(--neon-color)`;
    });
    
    const textElements = document.querySelectorAll('.neon-title, .logo, .member-nick');
    textElements.forEach(el => {
        el.style.textShadow = `0 0 ${intensity * 2}px var(--neon-color)`;
    });
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
    saveSettings();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–µ–æ–Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
function updateAllNeonElements(color) {
    // –ì—Ä–∞–Ω–∏—Ü—ã –∏ —Ç–µ–Ω–∏
    const borderElements = document.querySelectorAll('.neon-nav, .neon-btn, .nav-btn, .member-card, .neon-input, .modal-content, .neon-cat-btn, .title-box, .search-filter, .setting-card');
    
    borderElements.forEach(el => {
        el.style.borderColor = color;
        el.style.boxShadow = el.style.boxShadow.replace(/#[a-fA-F0-9]{6}/g, color);
    });
    
    // –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ç–µ–Ω–∏
    const textElements = document.querySelectorAll('.neon-title, .logo, .member-nick, .setting-title, .member-role');
    
    textElements.forEach(el => {
        el.style.textShadow = el.style.textShadow.replace(/#[a-fA-F0-9]{6}/g, color);
    });
    
    // –§–æ–Ω–æ–≤—ã–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã
    document.body.style.backgroundImage = 
        `linear-gradient(${color}0f 1px, transparent 1px),
         linear-gradient(90deg, ${color}0f 1px, transparent 1px)`;
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
function saveSettings() {
    const settings = {
        color: currentColor,
        snow: document.getElementById('snow-toggle').checked,
        intensity: document.getElementById('neon-intensity').value
    };
    
    localStorage.setItem('fame_settings', JSON.stringify(settings));
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
function loadSettings() {
    const saved = localStorage.getItem('fame_settings');
    if (saved) {
        const settings = JSON.parse(saved);
        
        // –¶–≤–µ—Ç
        if (settings.color) {
            const colorOption = document.querySelector(`.color-option[data-color="${settings.color}"]`);
            if (colorOption) {
                colorOption.click();
            }
        }
        
        // –°–Ω–µ–≥
        if (document.getElementById('snow-toggle')) {
            document.getElementById('snow-toggle').checked = settings.snow !== false;
            document.getElementById('snow-toggle').dispatchEvent(new Event('change'));
        }
        
        // –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å
        if (settings.intensity && document.getElementById('neon-intensity')) {
            document.getElementById('neon-intensity').value = settings.intensity;
            document.getElementById('neon-intensity').dispatchEvent(new Event('input'));
        }
    }
}

// –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ú–°–ö
function initRealTime() {
    function updateTime() {
        const now = new Date();
        const moscowTime = new Date(now.toLocaleString("en-US", {timeZone: "Europe/Moscow"}));
        
        const hours = moscowTime.getHours().toString().padStart(2, '0');
        const minutes = moscowTime.getMinutes().toString().padStart(2, '0');
        const seconds = moscowTime.getSeconds().toString().padStart(2, '0');
        
        const timeElement = document.getElementById('current-time');
        if (timeElement) {
            timeElement.textContent = `${hours}${minutes}.${seconds}`;
        }
    }
    
    updateTime();
    setInterval(updateTime, 1000);
}

// –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
window.showDetails = showDetails;
window.openModal = openModal;
window.closeModal = closeModal;